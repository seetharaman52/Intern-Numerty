<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-18">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" type="text/css" href="style.css">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    </head>
    <body>
        <div class="container-sm border">
            <p class="fs-2 text-center fw-bold fst-italic text-decoration-underline mt-5 text-white">Forms</p>
            <div class="row justify-content-center">
                <div class="col-sm-6">
                    <form action="/store">
                        <label class="fs-5 form-label fst-italic text-white"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-person" viewBox="0 0 16 16">
                            <path d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6m2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0m4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4m-1-.004c-.001-.246-.154-.986-.832-1.664C11.516 10.68 10.289 10 8 10s-3.516.68-4.168 1.332c-.678.678-.83 1.418-.832 1.664z"/>
                          </svg>Full Name</label>
                        <input type="text" class="form-control" id="customerName" placeholder="e.g. Johnwick">

                        <label class="fs-5 form-label my-2 fst-italic mt-3 text-white"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-envelope-at-fill" viewBox="0 0 16 16">
                            <path d="M2 2A2 2 0 0 0 .05 3.555L8 8.414l7.95-4.859A2 2 0 0 0 14 2zm-2 9.8V4.698l5.803 3.546zm6.761-2.97-6.57 4.026A2 2 0 0 0 2 14h6.256A4.5 4.5 0 0 1 8 12.5a4.49 4.49 0 0 1 1.606-3.446l-.367-.225L8 9.586zM16 9.671V4.697l-5.803 3.546.338.208A4.5 4.5 0 0 1 12.5 8c1.414 0 2.675.652 3.5 1.671"/>
                            <path d="M15.834 12.244c0 1.168-.577 2.025-1.587 2.025-.503 0-1.002-.228-1.12-.648h-.043c-.118.416-.543.643-1.015.643-.77 0-1.259-.542-1.259-1.434v-.529c0-.844.481-1.4 1.26-1.4.585 0 .87.333.953.63h.03v-.568h.905v2.19c0 .272.18.42.411.42.315 0 .639-.415.639-1.39v-.118c0-1.277-.95-2.326-2.484-2.326h-.04c-1.582 0-2.64 1.067-2.64 2.724v.157c0 1.867 1.237 2.654 2.57 2.654h.045c.507 0 .935-.07 1.18-.18v.731c-.219.1-.643.175-1.237.175h-.044C10.438 16 9 14.82 9 12.646v-.214C9 10.36 10.421 9 12.485 9h.035c2.12 0 3.314 1.43 3.314 3.034zm-4.04.21v.227c0 .586.227.8.581.8.31 0 .564-.17.564-.743v-.367c0-.516-.275-.708-.572-.708-.346 0-.573.245-.573.791"/>
                          </svg>Email</label>
                        <input type="email" class="form-control" id="customerEmail" placeholder="e.g. john@gmail.com">

                        <label class="fs-5 form-label my-2 fst-italic mt-3 text-white"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-calendar-event-fill" viewBox="0 0 16 16">
                            <path d="M4 .5a.5.5 0 0 0-1 0V1H2a2 2 0 0 0-2 2v1h16V3a2 2 0 0 0-2-2h-1V.5a.5.5 0 0 0-1 0V1H4zM16 14V5H0v9a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2m-3.5-7h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5"/>
                          </svg>Date of Birth</label>
                        <input type="date" id="CDob" class="form-control">

                        <label class="fs-5 form-label my-2 fst-italic mt-3 text-white"><svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" fill="currentColor" class="bi bi-phone-fill" viewBox="0 0 16 16">
                            <path d="M3 2a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2zm6 11a1 1 0 1 0-2 0 1 1 0 0 0 2 0"/>
                          </svg>Phone number</label>
                        <input type="number" id="customerNumber" class="form-control">

                        <label class="fs-5 form-label my-2 fst-italic mt-3 text-white"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-geo-alt-fill" viewBox="0 0 16 16">
                            <path d="M8 16s6-5.686 6-10A6 6 0 0 0 2 6c0 4.314 6 10 6 10m0-7a3 3 0 1 1 0-6 3 3 0 0 1 0 6"/>
                          </svg>Address</label>
                        <textarea class="form-control" cols="20" rows="5" id="cAddress"></textarea>

                        <div class="mt-4 text-center mb-4">
                            <!-- <button type="button" class="zoom-in border-0 rounded-2 p-2" data-bs-toggle="modal" data-bs-target="#submitModal">Register</button> -->
                            <button type="button" id="registerButton" class="zoom-in border-0 rounded-2 p-2">Register</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- First Modal -->
        <div class="modal fade" id="submitModal" tabindex="-1" aria-labelledby="ModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
              <div class="modal-content">
                <div class="modal-header">
                  <h1 class="modal-title fs-5" id="ModalLabel">Submit the form?</h1>
                  <!-- <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button> -->
                </div>
                <div class="modal-body alert alert-danger">
                  Your data is private and secure with us!
                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">No</button>
                  <button type="button" class="btn btn-primary" id="yesButton">Yes</button>
                </div>
              </div>
            </div>
          </div>

        <!-- Second Modal -->
        <div class="modal fade" id="successModal" tabindex="-1" aria-labelledby="successModalLabel" aria-hidden="true">
          <div class="modal-dialog modal-dialog-centered">
              <div class="modal-content">
                  <div class="modal-header">
                      <h1 class="modal-title fs-5" id="successModalLabel">Submitted successfully!</h1>
                  </div>
                  <div class="modal-body">
                      Your data has been successfully submitted.
                  </div>
                  <div class="modal-footer">
                      <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Close</button>
                  </div>
              </div>
          </div>
        </div>

        <!-- Modal template for validation messages -->
        <div class="modal fade" id="validationModal" tabindex="-1" aria-labelledby="validationModalLabel" aria-hidden="true">
          <div class="modal-dialog modal-dialog-centered">
              <div class="modal-content">
                  <div class="modal-header">
                      <h1 class="modal-title fs-5" id="validationModalLabel">Validation Error</h1>
                  </div>
                  <div class="modal-body" id="validationModalBody">
                      <!-- Validation error message will be inserted here -->
                  </div>
                  <div class="modal-footer">
                      <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Close</button>
                  </div>
              </div>
          </div>
        </div>
        <script src="https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
        <script>
          $(document).ready(function() {
            $('#registerButton').click(function() {
            
              var customerName = $('#customerName').val().trim();
              var customerEmail = $('#customerEmail').val().trim();
              var CDob = $('#CDob').val().trim();
              var customerNumber = $('#customerNumber').val().trim();
              var cAddress = $('#cAddress').val().trim();
              var flag = true;

              if (customerName === '' && customerEmail === '' && CDob === '' && customerNumber === '' && cAddress === '') {
                flag = false;
                $('#validationModalBody').html('Please fill in all fields.');
                $('#validationModal').modal('show');
                return;
              }

              if (customerName === ''){
                flag = false;
                $('#validationModalBody').html('Please fill in the Name.');
                $('#validationModal').modal('show');
                return;
              }
              else if (customerEmail === ''){
                flag = false;
                $('#validationModalBody').html('Please fill in the Email.');
                $('#validationModal').modal('show');
                return;
              }
              else if (CDob === ''){
                flag = false;
                $('#validationModalBody').html('Please fill in the Date of birth.');
                $('#validationModal').modal('show');
                return;
              }
              else if (customerNumber === ''){
                flag = false;
                $('#validationModalBody').html('Please fill in the number.');
                $('#validationModal').modal('show');
                return;
              }
              else if (customerNumber.length !== 10){
                flag = false;
                $('#validationModalBody').html('Number has lesser or more than 10 digits.');
                $('#validationModal').modal('show');
              }
              else if (cAddress === ''){
                flag = false;
                $('#validationModalBody').html('Please fill in the Address.');
                $('#validationModal').modal('show');
                return;
              }
              else{
                flag = true;
              }

              if (flag){
                $('#submitModal').modal('show');
              }
            });

          $('#yesButton').click(function(){
            $('#submitModal').modal('hide');
            var customerName = $('#customerName').val().trim();
            var customerEmail = $('#customerEmail').val().trim();
            var CDob = $('#CDob').val().trim();
            var customerNumber = $('#customerNumber').val().trim();
            var cAddress = $('#cAddress').val().trim();

            $.ajax({
                url: '/store',
                method: 'POST',
                data: {
                    customerName: customerName,
                    customerEmail: customerEmail,
                    CDob: CDob,
                    customerNumber: customerNumber,
                    cAddress: cAddress
                },
                success: function(response) {
                    $('#successModal').modal('show');
                },
                error: function(xhr, status, error) {
                    console.error(xhr.responseText);
                }
              });
            })
            $('#successModal').on('hidden.bs.modal', function () {
              location.reload();
            });
          });
        </script>
    </body>
</html>